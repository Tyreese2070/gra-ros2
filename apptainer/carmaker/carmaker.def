Bootstrap: docker
From: osrf/ros:humble-desktop-full
%files 
    # Obtain files from 
    CD-CarMakerOffice-linux-14.0 /CD 
%post
    
    apt-get -y update
    apt-get -y install vim tree
    # Below may alr be in humble-desktop-full but just in case
    apt-get -y install python3-pip
    apt-get -y install python3.10-venv
    
    apt-get install -y libgl1-mesa-dri libglx-mesa0
    apt-get install -y libvulkan1 vulkan-tools
    apt-get install -y mesa-vulkan-drivers

    # Carmaker Deps
    export DEBIAN_FRONTEND=noninteractive
    echo "ttf-mscorefonts-installer msttcorefonts/accepted-mscorefonts-eula select true" | debconf-set-selections
    apt-get install -y --reinstall ttf-mscorefonts-installer
    dpkg-reconfigure -f noninteractive ttf-mscorefonts-installer
  
    # Graphics Drivers 
    apt install -y evince
    apt install -y software-properties-common
    add-apt-repository -y ppa:graphics-drivers/ppa
    apt update -y
    export DEBIAN_FRONTEND=noninteractive   
    apt install -y nvidia-driver-550

    cd CD
    chmod +x ipg-install
    ./ipg-install -batch -ipghome /opt/ipg || echo "Install warning: Check logs for license/package issues"

    # make sure Licenses is moved to CD
    mv Licenses /opt/ipg/etc
 
    cd /opt/ros
    ln -sfn humble ros2